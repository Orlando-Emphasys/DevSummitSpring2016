<h1>Listing articles</h1>

<%= link_to 'New article', new_article_path %>

<table class="table">
	<tr>
		<th>Title</th>
		<th>Text</th>
		<th colspan="3"></th>
	</tr>

	<% @articles.each do |article| %>
		<tr>
			<td><%= article.title %></td>
			<td><%= article.text %></td>
			<td><%= link_to 'Show', article_path(article) %></td>
			<td><%= link_to 'Edit', edit_article_path(article) %></td>
			<td><%= link_to 'Destroy', article_path(article), :class => 'delete'%></td>
		</tr>
	<% end %>
</table>
<div id="deleteConfirm">
	<p>Delete this article?</p>
</div>

<script type="text/javascript">
	$(function(){

		var href;
		$('#deleteConfirm').dialog({
			resizable:false,
			modal: true,
			autoOpen: false,
			buttons:{
				Yes: function(){
					$.ajax({
						type: "DELETE",
						url: href
					});

					$(this).dialog("close");
				},
				Cancel: function(){
					$(this).dialog("close");
				}
			}
		});

		$('.delete').on('click', function(e){
			e.preventDefault();

			href = $(this).attr('href');

			$('#deleteConfirm').dialog("open");
		});
	});
</script>
